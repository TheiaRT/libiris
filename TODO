Consider using a thread pool:
https://github.com/progschj/ThreadPool
